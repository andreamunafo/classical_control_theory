---

title: Part 2 Recap


keywords: fastai
sidebar: home_sidebar



nb_path: "17_Part_2_recap.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 17_Part_2_recap.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Nyquist-Stability-Criterion">Nyquist Stability Criterion<a class="anchor-link" href="#Nyquist-Stability-Criterion"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><p><strong>Goal</strong></p>
<ul>
<li>When we want to study the stability of the closed loop system:<ul>
<li>We want to find the roots of $1+ùê∫(ùë†)ùêª(ùë†)=0$, </li>
<li>this corresponds to take the open loop transfer function $G(s)H(s)$, add 1 and find its zeros.</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Why is this difficult</strong></p>
<ul>
<li>The system can be high order (e.g. order 50), </li>
<li>Finding zeros would only give us stability information, </li>
<li>Other information could be useful (e.g. stability margins).</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Cauchy's-argument-principle">Cauchy's argument principle<a class="anchor-link" href="#Cauchy's-argument-principle"> </a></h4><blockquote><ul>
<li>We can tell the relative difference between the number of poles and zeros inside of a contour by counting how many time the plot circles the origin and in which direction</li>
</ul>
</blockquote>
<ul>
<li><p>Apply Caushy's argument principle to know if there are zeros of $1+GH$ in the right half plane (in which case the system is unstable)</p>
</li>
<li><p>Plot $GH$ and shift the origin to the left by 1:we can look at how many circling of the point $-1+0j$ the plot of $GH$ does.</p>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="The-Nyquist-Plot">The Nyquist Plot<a class="anchor-link" href="#The-Nyquist-Plot"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Steps:</strong></p>
<ul>
<li>Take the open loop transfer function $GH$</li>
<li>Plot the Nyquist plot of $GH$ <ul>
<li><ol>
<li>Set $s=j\omega$ in the transfer function</li>
</ol>
</li>
<li><ol>
<li>Sweep $\omega \in [0, \infty]$ and plot the resulting complex numbers</li>
</ol>
</li>
<li><ol>
<li>Draw the reflection about the real axis to account for negative $\omega$</li>
</ol>
</li>
<li>Note that the Nyquist contour is traced in the <strong>clock-wise</strong> direction (by convention)</li>
</ul>
</li>
</ul>
<p>Key is step #2:</p>
<ul>
<li>For simple transfer functions there are only four points that we need to solve for<ul>
<li><ol>
<li>$|G|$ and $\angle G$ at $\omega=0$ (start of the plot)</li>
</ol>
</li>
<li><ol>
<li>$|G|$ and $\angle G$ at $\omega=\infty$ (mid point of the plot)</li>
</ol>
</li>
<li><ol>
<li>Intersections with the imaginary axis </li>
</ol>
</li>
<li><ol>
<li>Intersections with the real axis </li>
</ol>
</li>
</ul>
</li>
</ul>
<ul>
<li>Count the number of times the point $-1$ is encircled and in which direction</li>
<li>Determine the relative number of poles and zeros inside the nyquist contour.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Therefore:
$$
Z = N + P
$$</p>
<p>where</p>
<ul>
<li>$Z$ is the number of zeros in the right half plane (or poles in closed loop)</li>
<li>$N$ is the number of clockwise encirclements of -1</li>
<li>$P$ is the number of open loop right half plane poles</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Stability-margins">Stability margins<a class="anchor-link" href="#Stability-margins"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><p>Gain and Phase margin: extra gain or phase that we have available before the system starts to oscillates or become unstable</p>
</li>
<li><p>Robustness of the system</p>
</li>
<li><p>Makes it possible to quantify how stable a system is</p>
<ul>
<li>Systems (or designs) that have less margin could be considered as being "less" stable: smaller variations in the system could lead to instability</li>
</ul>
</li>
<li><p>We want our controller to be robust to these because we cannot know our system perfectly and hence we need margins.</p>
</li>
<li><p>The more uncertainty we have the more margin we should design in.</p>
</li>
</ul>
<ul>
<li><strong>Gain margin</strong>: The gain required to cross the 0dB line at the frequency where phase is $-180^o$</li>
<li><strong>Phase margin</strong>: how much phase delay takes to make $-180^o$ phase at the 0 $dB$ gain frequency. </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<table style='margin: 0 auto' rules=none>
<tr>
<td> <img src="img/63.stability_margins-bode-2-1.png" alt="img/63.stability_margins-bode-2.png" style="width: 500px;"/> </td>
<td> <img src="img/64.stability_margins-bode-phase-margin-1.png" alt="img/64.stability_margins-bode-phase-margin-1.png" style="width: 500px;"/> </td>
</tr>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Uncertainty in one specific parameters can affect you more than you think.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Loop-analysis-and-loop-shaping">Loop analysis and loop shaping<a class="anchor-link" href="#Loop-analysis-and-loop-shaping"> </a></h2><p><strong>Feedback Goals</strong></p>
<ul>
<li>Stability of the closed loop system</li>
<li>Performance while tracking inputs<ul>
<li>tracking error, typically specified in terms of steady state error to specific inputs:<ul>
<li>e.g., error to step inputs less than $5\%$</li>
</ul>
</li>
<li>behaviour of the transient, typically specified in terms of bandwidth, rise time, settling time, damping ratio, overshoot (these are requirements for the transfer function between $Y$ and $Y_{ref}$).</li>
</ul>
</li>
<li>Robustness to noise measurement and disturbances</li>
</ul>
<ul>
<li>One advantage of the Nyquist stability theorem is that it is based on the loop transfer function $L = GR$, </li>
<li>Easy to see how the controller influences the loop transfer function. </li>
<li><strong>Loop shaping</strong>: Choose a compensator that gives a loop transfer function with a desired shape. </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Sensitivity-and-Complementary-Sensitivity-Functions">Sensitivity and Complementary Sensitivity Functions<a class="anchor-link" href="#Sensitivity-and-Complementary-Sensitivity-Functions"> </a></h2><p>We want to design $R$ so that all transfer functions have good properties</p>
<ul>
<li>tracking (at freq. where this is important)</li>
<li>disturbance rejection (at freq. where this is important)</li>
<li>noise attenuation (at freq. where this is important)</li>
</ul>
<ul>
<li>$L(s)=G(s)R(s)$</li>
<li>$S(s)=\frac{1}{1+L(s)}$</li>
<li>$T(s)=\frac{L}{1+L(s)}$</li>
</ul>
<table style='margin: 0 auto' rules=none>
<tr>
    <td> <img src="img/loop-shaping-splut-mag.png" alt="sensitivity-and-complementary-with-freq" style="width: 700px"/> </td>
    <td> <img src="img/loop-shapinig-L-mag.png" alt="loop-shapinig-L-mag" style="width: 700px"/> </td>
</tr>
</table><ul>
<li>Is a trial-and-error procedure</li>
<li>We typically start with a Bode plot of the process transfer function $G$</li>
<li>Choosing the gain crossover frequency $\omega_{gc}$ is a major design decision: a compromise between attenuation of load disturbances and injection of measurement noise</li>
<li>Finally shape the loop transfer function by changing the controller gain and adding poles and zeros to the controller transfer function</li>
<li>The controller gain at low frequencies can be increased by so-called <em>lag compensation,</em> and the behavior around the crossover frequency can be changed by so-called <em>lead compensation.</em></li>
</ul>
<p><em>Nominal sensitivity peak</em>
$$
M_s = \max_{0 \leq \omega \leq \infty} | S(j\omega) | = \max_{0 \leq \omega \leq \infty} \Big| \frac{1}{1+G(j\omega)R(j\omega)} \Big|
$$</p>
<ul>
<li>$M_s$ gives us an indication of how far $L$ is from -1</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Relationship-between-loop-function-harmonic-response-and-closed-loop">Relationship between loop function harmonic response and closed loop<a class="anchor-link" href="#Relationship-between-loop-function-harmonic-response-and-closed-loop"> </a></h2><ul>
<li>Relationship between the harmonic response of the loop transfer function $L(j\omega)$ and the closed loop $H(j\omega)$</li>
</ul>
$$
|H(j\omega)| = \frac{|L(j\omega)|}{|1+L(j\omega)|} = \frac{|L(j\omega)|}{\sqrt{1+|L(j\omega)|^2}}
$$<ul>
<li>Translation of design requirements into requirements on the Bode plot of the loop funtion (barriers)</li>
<li>The "barriers" on the Bode plots are there to help us shape the desired harmonic response of the loop function</li>
<li>The controller is designed so that the loop function always stays within the admissible regions</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Root-Locus">Root Locus<a class="anchor-link" href="#Root-Locus"> </a></h2><ul>
<li>System with multiple known parameters, and one unknown or varying parameter (K)</li>
<li>Changing $K$ changes the locations of the poles</li>
<li>How to design a system that meets the requirements:<ul>
<li>What value of $K$ should I choose to meet the requirements (i.e., that places the poles at the correct location in the $s$ plane)</li>
</ul>
</li>
<li><p>What is the effect of variations on a control system that has been already designed:</p>
<ul>
<li>How sensitive is the system to a value of $K$ that is slightly different than what we have estimated (or predicted).</li>
</ul>
</li>
<li><p>Rules to sketch the root locus</p>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Translate requirements into s-plane requirements:</li>
</ul>
<table style='margin: 0 auto' rules=none>
<tr>
    <td> <img src="img/root_locus-3.png" alt="root-locus-constraints" style="height: 250px;"/> </td>
    <td> <img src="img/root_locus-2.png" alt="root-locus-constraints" style="height: 250px;"/> </td>
    <td> <img src="img/root_locus-1.png" alt="root-locus-constraints" style="height: 250px;"/> </td>
</tr>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><p><strong>The angle condition:</strong> $\angle (G(s)) = (2n + 1)\pi$</p>
</li>
<li><p><strong>The magnitude condition:</strong> $|KG(s)|=1$</p>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Phase-Lead/Phase-Lag-Compensators">Phase Lead/Phase Lag Compensators<a class="anchor-link" href="#Phase-Lead/Phase-Lag-Compensators"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>A lead compensator can increase the stability or speed of reponse of a system; </li>
<li>A lag compensator can reduce (but not eliminate) the steady-state error. </li>
</ul>
$$
R(s) = \frac{\frac{s}{w_z}+1}{\frac{s}{w_p}+1} = \frac{w_p}{w_z}\frac{s + w_z}{s + w_p}
$$<p>Lead compensator:</p>
<ul>
<li>$w_z &lt; w_p$</li>
<li>$K=\frac{w_p}{w_z}$ (gain)</li>
</ul>
<p>Lag compensator</p>
<ul>
<li>$w_z &gt; w_p$</li>
<li>$K=\frac{w_p}{w_z}$ (gain)</li>
</ul>
<ul>
<li>Multiplying the two T.F. together means adding everything together on the Bode plot</li>
<li>Lead/Lag compensator:<ul>
<li>Behaves like a real zero early on, at low frequency</li>
<li>Until the real pole pulls it back at high frequency</li>
<li>See blue line for its approximate representation</li>
</ul>
</li>
</ul>
<table style='margin: 0 auto' rules=none>
<tr>
<td> <img src="img/lead-lag-compensator-lead-bode-ex-1.png" alt="lead-lag-compensator-lead-bode-ex" style="width: 550px;"/> </td>
<td> <img src="img/lead-lag-compensator-lead-bode-ex-3.png" alt="lead-lag-compensator-lead-bode-ex" style="width: 550px;"/> </td>
</tr>
</table><ul>
<li>Using the root locus and Bode plots to place the zero and pole</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="PID-Controllers">PID Controllers<a class="anchor-link" href="#PID-Controllers"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><p>PID = Proportional-Integral-Derivative</p>
<ul>
<li>Describes how the error term is treated before being sum and sent into the plant </li>
</ul>
</li>
<li><p>It is a simple and effective controller in a wide range of applications</p>
</li>
<li>Majority of controllers in industrial applications are PIDs</li>
</ul>
<p>The general structure of a PID controller is:</p>
<table style='margin: 0 auto' rules=none>
<tr>
<td> <img src="img/PID-Controller-general.png" alt="PID-Controller-general" style="width: 550px;"/> </td>
</tr>
</table><ul>
<li>The three gains $K_p, K_i, K_d$ are adjustable and can be tuned to the specific application</li>
<li>Varying $K_p, K_i, K_d$ means adjusting how sensitive the system is across the three paths</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Ziegler Nichols tuning rules</li>
<li>Practical problems:<ul>
<li>Derivative is sensitive to noise<ul>
<li>Filtering and Set Point Weighting</li>
</ul>
</li>
<li>If the integral of the error grows too much, the control output might hit actuation limits<ul>
<li>Integral windup: Initializing the controller integral to a desired value or zeroing the integral value every time the error is equal to, or crosses zero reduces the problem.</li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Solving the Cruise Control Problem deploying a PID controller on a car</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Fin</strong></p>

</div>
</div>
</div>
</div>
 

